   LIST P=18F4550
#include <p18f4550.inc>                
;The high-priority interrupt vector is at 000008h and the low-priority interrupt vector is at 000018h.
   CONFIG FOSC = INTOSCIO_EC
   CONFIG WDT = OFF
   CONFIG MCLRE =OFF
   CONFIG PBADEN = ON
   CONFIG LVP=OFF
   ORG 0X0000
   GOTO MAIN
   
   ORG 0X0008
   GOTO SERVICIOHP   
   
   ORG 0X0018
   CBLOCK 0X20  ;### VARIABLES###
   NUMERO
   REG1
   REG2
   WTEMP
   UNIDAD ;0X24
   DECENA ;0X25
   CENTENA; 0X26
   BANDERAS
   UNIDAD1
   DECENA1
   CENTENA1
   BANDERA2 ;0X2B
   CERO
   UNIDAD2 ;0X2D
   DECENA2; 0X2E
   CENTENA2 ;2F
   NUMEROH 
   NUMEROL
   NUMERO1H
   NUMERO1L 
   NUMERO2H 
   NUMERO2L 
   
   ENDC
   #DEFINE L1 PORTB,0
   #DEFINE L2 PORTB,1
   #DEFINE L3 PORTB,2
   #DEFINE L4 PORTB,3
   #DEFINE C1 PORTB,4
   #DEFINE C2 PORTB,5
   #DEFINE C3 PORTB,6
   #DEFINE C4 PORTB,7
   #DEFINE RS PORTE,0
   #DEFINE RW PORTE,1
   #DEFINE E PORTE,2
   #DEFINE ENTER BANDERA2,0
   #DEFINE CAMBIO BANDERA2,1
   #DEFINE SM BANDERAS,0
   #DEFINE RST BANDERAS,1
   #DEFINE ML BANDERAS,2
   #DEFINE DV BANDERAS,3
   #DEFINE CP BANDERAS,4
   #DEFINE POT2 BANDERAS,5
   #DEFINE POT BANDERAS,6
   #DEFINE FACT BANDERAS,7
 
   
;Iniciamos:
INIT_OSC
   CLRF OSCTUNE,0
   MOVLW B'01110110'
   MOVWF OSCCON
   RETURN
INIT_PORTS
   MOVLW B'00001111'
   MOVWF LATB
   MOVWF ADCON1
   MOVLW B'11110000'
   MOVWF TRISB
   MOVLW H'0F'
   MOVWF TRISA;CONFIGURAMOS A PARA PRUEBAS
   CLRF TRISD
   CLRF TRISE
   CLRF LATD
   CLRF LATE
   CLRF LATA
   RETURN
INIT_INTERRUPCIONES
   BSF	INTCON2,7 ; DESHABILITA LAS PULL UPS EN EL PUERTO B
   CLRF INTCON
   BSF INTCON,7; HABILITAMOS EL GLOBAR INTERRUPT
   BSF INTCON,3 ;HABILITAMOS LAS INTERRUPCIONES POR EL PORTB
   BSF INTCON2,0 ; LAS INTERRUPCIONES DEL PUERTO B SERAN DE ALTA PRIORIDAD
   RETURN
INIT_VARIABLES
   CLRF NUMERO
   CLRF CERO
   RETURN
INITS_LCD
   BCF RS
   MOVWF LATD
   BSF E
   CALL RET_20MS
   BCF E
   RETURN
CONFIG_8B
   CALL RET_20MS
   MOVLW H'38'
   CALL INITS_LCD
   MOVLW H'06'
   CALL INITS_LCD
   MOVLW H'0E';REALMENTE ES 0C PERO ESTOY PROBANDO PARA VER EL CURSOR
   CALL INITS_LCD
   MOVLW H'01'
   CALL INITS_LCD
   RETURN
DATO
   BSF RS
   MOVWF LATD
   BSF E
   CALL RET_20MS
   BCF E
   RETURN
   
   ORG 0X300
SERVICIOHP 
   MOVWF WTEMP ;PUSH WREG NO FUNCIONA!!!!
   CLRF WREG
   BCF INTCON,7  ; DESHABILITAMOS EL GLOBAR INTERRUPT
   BTFSC C1
   CALL COLUMNA1 ; COMPROBAMOS QUE EL BOTON PRESIONADO ESTA EN LA COLUMNA 1
   BTFSC C2
   CALL COLUMNA2 ; COMPROBAMOS QUE EL BOTON PRESIONADO ESTA EN LA COLUMNA 2
   BTFSC C3
   CALL COLUMNA3 ; COMPROBAMOS QUE EL BOTON PRESIONADO ESTA EN LA COLUMNA 3
   BTFSC C4
   CALL COLUMNA4 ; COMPROBAMOS QUE EL BOTON PRESIONADO ESTA EN LA COLUMNA 4
AR ;ANTI REBOTE DEL TECLADO
   MOVLW .15
   CPFSEQ PORTB
   GOTO AR
   BCF INTCON,0  ; LIMPIA LA BANDERA DE INTERRUPCION POR CAMBIO EN RB
   BCF INTCON,1  ; LIMPIA LA BANDERA DE INTERRUPCION EXTERNA
   BSF INTCON,7  ; HABILITAMOS EL GLOBAR INTERRUPT
   MOVF WTEMP,0 ;NO FUNIONA!!POP WREG
   RETFIE
   
COLUMNA1  
   BCF L1
   BTFSS C1
   MOVLW .49
   BSF L1
   BCF L2
   BTFSS C1
   MOVLW .52
   BSF L2
   BCF L3
   BTFSS C1
   MOVLW .55
   BSF L3
   BCF L4
   BTFSS C1
   GOTO CLEAR; CLEAR
   BSF L4
   BCF C1
   MOVWF NUMERO ;;SE GUARDA EN NUMERO, PARA MOSTRAR PRIMERO Y LUEGO GUARDAR EL NUMERO
   CALL DATO
   CALL GUARDAR
SALIDA
   RETURN
   
COLUMNA2
   BCF L1
   BTFSS C2
   MOVLW .50
   BSF L1
   BCF L2
   BTFSS C2
   MOVLW .53
   BSF L2
   BCF L3
   BTFSS C2
   MOVLW .56
   BSF L3
   BCF L4
   BTFSS C2
   MOVLW .48
   BSF L4
   BCF C2
   MOVWF NUMERO
   CALL DATO
   CALL GUARDAR
   RETURN
   
COLUMNA3
   BCF L1
   BTFSS C3
   MOVLW .51
   BSF L1
   BCF L2
   BTFSS C3
   MOVLW .54
   BSF L2
   BCF L3
   BTFSS C3
   MOVLW .57
   BSF L3
   BCF L4
   BTFSS C3
   GOTO FUNCION_ENTER ;ENTER
   MOVWF NUMERO
   CALL DATO
   CALL GUARDAR
SALIDA2
   BSF L4
   BCF C3
   RETURN
 
   
COLUMNA4
   BTFSC CAMBIO ;PRUEBA SI CAMBIO ESTA ACTIVO, SI NO ESTA ACTIVO, USA LAS PRIMERAS OPERACIONES
   GOTO OTRO_OPE
   BCF L1
   BTFSS C4
   MOVLW .8
   BSF L1
   BCF L2
   BTFSS C4
   MOVLW .4
   BSF L2
   BCF L3
   BTFSS C4
   MOVLW .2
   BSF L3
   BCF L4
   BTFSS C4
   MOVLW .1
   BSF L4
   GOTO FIN
OTRO_OPE ; EN CASP DE QUE CAMBIO ESTE ACTIVADO, SE VA A ESTA TABLA PARA COMPARACION, POTENCIA Y FACTORIAL
   BCF L1
   BTFSS C4
   MOVLW .128
   BSF L1
   BCF L2
   BTFSS C4
   MOVLW .64
   BSF L2
   BCF L3
   BTFSS C4
   MOVLW .32
   BSF L3
   BCF L4
   BTFSS C4
   MOVLW .16
   BSF L4
FIN
   MOVWF BANDERAS ;ACTIVAMOS LAS BANDERAS
   CALL TAB_OPE	   ; DE AQUI SACAMOS EL CARACTER A MOSTRAR	
   CALL DATO  ; MOSTRAMOS
   MOVF UNIDAD,0  ;YA QUE YA ELEGIMOS LA OPERACION, LO GUARDAMOS EN UNIDAD 1 Y ASI
   MOVWF UNIDAD1
   MOVF DECENA,0
   MOVWF DECENA1
   MOVF CENTENA,0
   MOVWF CENTENA1
   CLRF UNIDAD	; ELIMINAMOS TODO LO GUARDADO EN UNIDAD
   CLRF DECENA
   CLRF CENTENA
   RETURN
RET_200MS ;RETARDO DE 200MS PARA TESTEOS DE 1 SEGUNDO
   MOVLW .254
   MOVWF REG2,1
LOOP_RET200
   MOVLW .254
   MOVWF REG1,1
DECREMENTAR
   DECFSZ REG1,1
   GOTO DECREMENTAR
   DECFSZ REG2,1
   GOTO LOOP_RET200
   RETURN
TESTER_1SG: ;TESTEO PARA EL CAMBIO, ESPERA 0.4 SEGUNDOS CON ENTER PUESTO Y LUEGO ESPERA EL CLEAR PARA ACTIVAR
   BTFSS C3
   GOTO ENTRA
   CALL RET_200MS
   BTFSS C3
   GOTO ENTRA
   CALL RET_200MS
   BTFSS C3 
   GOTO ENTRA
   BCF L1
   BCF L2 ;SE ELIMINAN LAS DEMAS FILAS PARA QUE NO ESTORBEN
   BCF L3
LOOP_AS ;; ESPERA EL CLEAR, SI SE SUELTA EL ENTER, IGUAL SE SALE
   BTFSS C3
   GOTO ENTRA
   BTFSS C1
   GOTO LOOP_AS
   BTG CAMBIO
   BSF L1
   BSF L2
   BSF L3
   GOTO SALIDA2
   
TESTER_CLEAR_1SG ;; SE ESPERA 1 SEGUNDO PARA BORRAR TODA LA PANTALLA
   BTFSS C1
   GOTO BORRAR
   CALL RET_200MS
   BTFSS C1
   GOTO BORRAR
   CALL RET_200MS
   BTFSS C1 
   GOTO BORRAR
   CALL RET_200MS
   BTFSS C1
   GOTO BORRAR
   CALL RET_200MS
   BTFSS C1
   GOTO BORRAR
   CALL RET_200MS
   CALL RET_200MS
   GOTO INICIO
  
FUNCION_ENTER
   BSF L4
   GOTO TESTER_1SG
ENTRA	; SI NO SE DURA 1 SEGUNDO EN ENTER, VA AQUI
   BSF ENTER	
   MOVLW H'C1'		
   CALL INITS_LCD	; LE LLEVAMOS W COMO INSTRUCCION A LA LCD PARA MOVERNOS A LA SEGUNDA LINEA
   MOVLW .61
   CALL DATO	;LLEVAMOS EL =, COMO DATO 
   MOVF UNIDAD,0  ;YA QUE YA LE DIMOS ENTER, LO GUARDAMOS EN UNIDAD2Y ASI
   MOVWF UNIDAD2
   MOVF DECENA,0
   MOVWF DECENA2
   MOVF CENTENA,0
   MOVWF CENTENA2
   CLRF UNIDAD	; ELIMINAMOS TODO LO GUARDADO EN UNIDAD
   CLRF DECENA
   CLRF CENTENA
   GOTO SALIDA2
TAB_OPE	;PATRON PARA LAS OPERACIONES
   BTFSC SM
   MOVLW .43
   BTFSC RST
   MOVLW .45
   BTFSC ML
   MOVLW .42
   BTFSC DV
   MOVLW .47
   BTFSC CP
   MOVLW .34
   BTFSC POT2
   MOVLW .253
   BTFSC POT
   MOVLW .94  ;ES UNAS COMILLAS PORQUE NO HAY EL CUADRADO A LA DOS, HABRA QUE AGREGAR UN ^2, ASI
   BTFSC FACT
   MOVLW .33
   RETURN
GUARDAR
   MOVLW H'30'	
   SUBWF NUMERO,1 ; A NUMERO LE QUITA EL H.30 PARA QUE QUEDE EL NUMERO DECIMAL
   CALL RODAR	; RODAMOS Y GUARDAMOS EN UNIDAD
   MOVF NUMERO,0
   MOVWF UNIDAD
   RETURN
RODAR
   MOVF DECENA,0
   MOVWF CENTENA
   MOVF UNIDAD,0
   MOVWF DECENA
   RETURN
CLEAR
   BSF L4
   GOTO TESTER_CLEAR_1SG ;TESTEA SI ES 1G PARA REINICIAR
BORRAR
   MOVLW H'10' ;SE DEVUELVE UN PASO A LA IZQUIERDA
   CALL INITS_LCD
    MOVLW .0 	; AGREGA UN CARCTER NULO " "
    CALL DATO
   MOVLW H'10' ;LO DEJA NUEVAMENTE DONDE SE BORRO
   CALL INITS_LCD
   BCF C1
   GOTO SALIDA    
   
RET_20MS ;RETARDO  DE 20MS PARA LA PANTALLA LCD
   MOVLW .28
   MOVWF REG2,1
LOOP_RET20
   MOVLW .254
   MOVWF REG1,1
DECREMENTAR2
   DECFSZ REG1,1
   GOTO DECREMENTAR2
   DECFSZ REG2,1
   GOTO LOOP_RET20
   RETURN
MOSTRAR_RESULTADO
   MOVF CENTENA,0
   CPFSLT CERO ; TESTEA SI CENTENA ES 0
   GOTO DEC 	; EN CASO DE QUE SI SEA 0, NO MUESTRA NADA Y SE VA A DECENA
   ADDLW H'30' ; EN CASO DE QUE NO SEA 0, SE LE SUMA H.30 PARA LLEVAR EL NUMERO A ASCII Y ASI MOSTRATLO
   CALL DATO   ;;LEVA EL NUMERO A LA PANTALLA
DEC
   MOVLW .0 
   CPFSGT CENTENA ;COMPARAMOS CON CENTENA, SI CENTENA ES 0
   CPFSEQ DECENA  ; SI CENTENA ES 0, PREGUNTAMOS SI DECENA TAMBIEN LO ES. PARA NO MOSTRAR CEROS
   GOTO MOSTRAR_DEC ;EN CASO DE QUE CENTENA NO SEA 0, MUESTRA LO QUE HAYA EN DECENA, ASI SEA 0
   GOTO UNI	;SI DECENA ES 0, NO LO MUESTRA
MOSTRAR_DEC
   MOVF DECENA,0
   ADDLW H'30'
   CALL DATO
UNI
   MOVF UNIDAD,0 ; MUESTRA LO QUE HAYA EN UNIDAD, ASI SEA 0
   ADDLW H'30' 
   CALL DATO
   RETURN
   
CONVERSION_BCD_BIN
   CLRF NUMEROL
   CLRF NUMEROH
   TSTFSZ CENTENA
   CALL AGREGAR_CENTENA
   TSTFSZ DECENA
   CALL AGREGAR_DECENA
   TSTFSZ UNIDAD
   CALL AGREGAR_UNIDAD
   RETURN

AGREGAR_CENTENA
LOOP_C1
    MOVLW   B'01100100'  ; CARGA W=100      
    ADDWF NUMEROL, F	 ; SUMA 100 A NUMEROL Y GUARDA EL RESULTADO EN NUMEROL
    BTFSS STATUS, C           
    GOTO CONTINUE_LOOP1       
    INCF NUMEROH, F      ; SI C ES 1, SALTA PARA AUMENTAR EL VALOR DE NUMEROH
CONTINUE_LOOP1
     DECFSZ CENTENA, F	 ; DECREMENTA CENTENA. SI EL RESULTADO ES 0, SALTA A LA SIGUIENTE LINEA
     GOTO LOOP_C1	 ; SI CENTENA NO ES CERO, VUELVE AL INCICIO DEL BUCLE
     RETURN 		 ; CUANDO CENTENA LLEGA A CERO, ESCAPA DE LA SUBRUTINA

AGREGAR_DECENA
LOOP_D1
    MOVLW   B'00001010'  ; CARGA W=10      
    ADDWF NUMEROL, F	 ; SUMA 10 A NUMEROL Y GUARDA EL RESULTADO EN NUMEROL
    BTFSS STATUS, C           
    GOTO CONTINUE_LOOP2       
    INCF NUMEROH, F      ; SI C ES 1, SALTA PARA AUMENTAR EL VALOR DE NUMEROH
CONTINUE_LOOP2
     DECFSZ DECENA, F	 ; DECREMENTA DECENA. SI EL RESULTADO ES 0, SALTA A LA SIGUIENTE LINEA
     GOTO LOOP_D1	 ; SI DECENA NO ES CERO, VUELVE AL INCICIO DEL BUCLE
     RETURN 		 ; CUANDO DECENA LLEGA A CERO, ESCAPA DE LA SUBRUTINA

AGREGAR_UNIDAD
LOOP_U1     
    INCF NUMEROL, F	 ; SUMA 1 A NUMEROL Y GUARDA EL RESULTADO EN NUMEROL
    BTFSS STATUS, C           
    GOTO CONTINUE_LOOP3      
    INCF NUMEROH, F      ; SI C ES 1, SALTA PARA AUMENTAR EL VALOR DE NUMEROH
CONTINUE_LOOP3:
     DECFSZ UNIDAD, F	 ; DECREMENTA UNIDAD. SI EL RESULTADO ES 0, SALTA A LA SIGUIENTE LINEA
     GOTO LOOP_U1	 ; SI UNIDAD NO ES CERO, VUELVE AL INCICIO DEL BUCLE
     RETURN 		 ; CUANDO UNIDAD LLEGA A CERO, ESCAPA DE LA SUBRUTINA 
   
CONVERSION_BIN_BCD  
  CALL QUITAR_CENTENA
  CALL QUITAR_DECENA
  CALL QUITAR_UNIDAD
  RETURN

QUITAR_CENTENA
    CLRF CENTENA             ; REINICIA EL VALOR DE CENTENAS A 0
    MOVLW B'01100100'        ; CARGA W=100
LOOP_C2:
    SUBWF NUMEROL,F          ; RESTAMOS 100 A NUMEROL
    BTFSS STATUS,C           ; SI HAY CARRY, LA RESTA FUE EXITOSA
    GOTO BAJAR_H1
STEP    INCF CENTENA,F       ; INCREMENTA LAS CENTENAS EN 1
    GOTO LOOP_C2             ; REPITE EL BUCLE
BAJAR_H1 
    DECF NUMEROH,F
    BTFSC STATUS,C	     ; SI NO SE ACTIVA EL CARRY, NUMEROH=0
    GOTO STEP	             ; REPITE EL BUCLE, NO SIN ANTES AUMENTAR LAS CENTENAS
    ADDWF NUMEROL,F	     ; SE DEVUELVE LA ULTIMA RESTA EN NUMEROL
    INCF NUMEROH,F	     ; SE DEVUELVE EL ULTIMO DECREMENTO EN NUMEROH
    RETURN                   ; ESCAPE DE LA SUBRUTINA, SOLO SE ACTIVA SI NUMEROL<100 Y NUMEROH=0
        
QUITAR_DECENA
    CLRF DECENA              ; REINICIA EL VALOR DE DECENA A 0
    MOVLW B'00001010'        ; CARGA W=10
LOOP_D2:
    SUBWF NUMEROL,F          ; RESTAMOS 10 A NUMEROL
    BTFSS STATUS,C           ; SI HAY CARRY, LA RESTA FUE EXITOSA
    GOTO SALIR_D 
    INCF DECENA,F            ; INCREMENTA LAS DECENAS EN 1
    GOTO LOOP_D2             ; REPITE EL BUCLE
SALIR_D
    ADDWF NUMEROL,F	     ; SE DEVUELVE LA ULTIMA RESTA EN NUMEROL
    RETURN                   ; ESCAPE DE LA SUBRUTINA, SOLO SE ACTIVA SI NUMEROL<10 Y NUMEROH=0
   
QUITAR_UNIDAD
    CLRF UNIDAD              ; REINICIA EL VALOR DE UNIDAD A 0
LOOP_U2:
    DECF NUMEROL,F           ; RESTAMOS 1 A NUMEROL
    BTFSS STATUS,C           ; SI HAY CARRY, LA RESTA FUE EXITOSA
    GOTO SALIR_U
    INCF UNIDAD,F            ; INCREMENTA LAS DECENAS EN 1
    GOTO LOOP_U2             ; REPITE EL BUCLE
SALIR_U
    INCF NUMEROL,F           ; SE DEVUELVE LA ULTIMA RESTA EN NUMEROL
    RETURN                   ; ESCAPE DE LA SUBRUTINA, SOLO SE ACTIVA SI NUMEROL<10 Y NUMEROH=0

OPERAR
   
   MOVF CENTENA1,0
   MOVWF CENTENA
   MOVF DECENA1,0
   MOVWF DECENA
   MOVF UNIDAD1,0
   MOVWF UNIDAD
   CALL CONVERSION_BCD_BIN
   MOVF NUMEROH,0
   MOVWF NUMERO1H
   MOVF NUMEROL,0
   MOVWF NUMERO1L
   MOVF CENTENA2,0
   MOVWF CENTENA
   MOVF DECENA2,0
   MOVWF DECENA
   MOVF UNIDAD2,0
   MOVWF UNIDAD
   CALL CONVERSION_BCD_BIN
   MOVF NUMEROH,0
   MOVWF NUMERO2H
   MOVF NUMEROL,0
   MOVWF NUMERO2L
   BTFSC SM
   CALL SUMAR
   BTFSC RST
   CALL RESTAR
   BTFSC ML
   CALL MULTIPLICAR
   BTFSC DV
   CALL DIVIDIR
   BTFSC CP
   CALL COMPARAR
   BTFSC POT2
   CALL CUADRADO
   BTFSC POT 
   CALL POTENCIA
   BTFSC FACT 
   CALL FACTORIAL
   CALL CONVERSION_BIN_BCD
   RETURN
     
SUMAR 
   MOVF NUMERO1L,0 ;W= NUMERO1L
   ADDWF NUMERO2L,0 ;W= NUMERO1L + NUMERO2L
   MOVWF NUMEROL ;NUMEROL= RESULTADO 
   BTFSC STATUS,C 
   INCF NUMERO1H,1 ; INCREMENTO EN NUMERO1H DE ACTIVARSE EL CARRY
   MOVF NUMERO1H,0 ;W= NUMERO1H
   ADDWF NUMERO2H,0 ;W= NUMERO1H + NUMERO2H
   MOVWF NUMEROH ;NUMEROH= W 
   RETURN

RESTAR
   MOVF NUMERO2L,0 ;W= NUMERO1L
   SUBWF NUMERO1L,0 ;W= NUMERO1L - NUMERO2L
   MOVWF NUMEROL ;NUMEROL= RESULTADO 
   BTFSS STATUS,C 
   DECF NUMERO1H,1 ; DECREMENTO EN NUMERO1H DE NO ACTIVARSE EL CARRY
   MOVF NUMERO2H,0 ;W= NUMERO2H
   SUBWF NUMERO1H,0 ;W= NUMERO1H - NUMERO2H
   MOVWF NUMEROH ;NUMEROH= W 
   RETURN
      
MULTIPLICAR ; UNIDAD DECENA CENTENA AGARRADAS DEL SEGUNDO NUMERO EN BCD
   CLRF NUMEROL        ;NUMEROL= 0
   CLRF NUMEROH	       ;NUMEROH= 0
REP_UNI   
   DECF UNIDAD
   BTFSS STATUS,C
   GOTO REP_DEC
   MOVF NUMERO1L,0      ;W= NUMERO1L
   ADDWF NUMEROL,1      ;NUMEROL= NUMEROL + NUMERO1L
   BTFSC STATUS,C 	
   GOTO OPEN
   MOVF NUMERO1H,0       ;W= NUMERO1H
CLOSE ADDWF NUMEROH,1     ;NUMEROH= NUMEROH + NUMERO1H
   GOTO REP_UNI
OPEN INCF NUMERO1H,0       ;W= NUMERO1H+1
   GOTO CLOSE
REP_DEC 
   DECF DECENA,1
   BTFSS STATUS,C
   GOTO REP_CEN
   MOVLW .10
   MOVWF UNIDAD		;UNIDAD= 10
   GOTO REP_UNI   
REP_CEN
   DECF CENTENA,1
   BTFSS STATUS,C
   GOTO RESULTADO_MULTI
   MOVLW .10
   MOVWF DECENA		;DECENA= 10
   GOTO REP_DEC
RESULTADO_MULTI
   RETURN

DIVIDIR
   CLRF NUMEROL
   CLRF NUMEROH
   CALL CONDICION
LOOP_DIVIDIR1 MOVF NUMERO2L,0 ;W= NUMERO2L
   SUBWF NUMERO1L,1 ;NUMERO1L= NUMERO1L - NUMERO2L
   BTFSS STATUS,C 
   GOTO BAJAR_H
LOOP_DIVIDIR2 MOVF NUMERO2H,0 ;W= NUMERO2H
   SUBWF NUMERO1H,1 ;NUMERO1H= NUMERO1H - NUMERO2H
   BTFSS STATUS,C
   GOTO RESULTADO_DIVI
   INCF NUMEROL,1   
   BTFSC STATUS,C
   INCF NUMEROH,1
   GOTO LOOP_DIVIDIR1
BAJAR_H 
   DECF NUMERO1H,1 ; DECREMENTO EN NUMERO1H DE NO ACTIVARSE EL CARRY   
   BTFSC STATUS,C
   GOTO LOOP_DIVIDIR2
RESULTADO_DIVI 
   RETURN

CONDICION    
   MOVLW .0
   CPFSGT NUMERO2L
   CPFSEQ NUMERO2H
   RETURN
   GOTO O_F
   
COMPARAR
   CALL MENOR
   CALL IGUAL
   CALL MAYOR
   RETURN

MENOR
   MOVF NUMERO2H,0
   CPFSLT NUMERO1H ; NUMERO1H < NUMERO2H?
   RETURN
   MOVF NUMERO2L,0
   CPFSLT NUMERO1L ; NUMERO1H < NUMERO2H?
   RETURN
   MOVLW B'00100000'
   MOVWF BANDERAS
   RETURN
   
IGUAL
   MOVF NUMERO2H,0
   CPFSEQ NUMERO1H,0 ; NUMERO1H = NUMERO2H?
   RETURN
   MOVF NUMERO2L,0
   CPFSEQ NUMERO1L,0 ; NUMERO1L = NUMERO2L?
   RETURN
   MOVLW B'01000000'
   MOVWF BANDERAS
   RETURN
   
MAYOR
   MOVF NUMERO2H,0
   CPFSGT NUMERO1H ; NUMERO1H > NUMERO2H?
   RETURN
   MOVF NUMERO2L,0
   CPFSGT NUMERO1L ; NUMERO1L > NUMERO2L?
   RETURN
   MOVLW B'10000000'
   MOVWF BANDERAS
   RETURN

CUADRADO
   RETURN
   
POTENCIA
   RETURN
   
FACTORIAL
   RETURN
   
CHECK   
       MOVLW .3
       CPFSGT NUMEROH ;COMPROBACION DE QUE SE CUMPLA: NUMEROH>3
       GOTO CHECK1
       GOTO O_F ;SEÑAL DE OVERFLOW EN LA OPERACION
CHECK1 CPFSEQ NUMEROH ;COMPROBACION DE QUE SE CUMPLA: NUMEROH=3
       RETURN
       MOVLW .231
       CPFSGT NUMEROL ;COMPROBACION DE QUE SE CUMPLA: NUMEROL>231
       RETURN
       GOTO O_F ;SEÑAL DE OVERFLOW EN LA OPERACION

O_F 
    MOVLW B'01000000'
    MOVWF UNIDAD
    MOVLW B'01000000'
    MOVWF DECENA
    MOVLW B'01000000'
    MOVWF CENTENA
    
    GOTO MAIN
    
MAIN
   CALL INIT_OSC
   CALL INIT_PORTS
   CALL INIT_INTERRUPCIONES
INICIO
   CALL CONFIG_8B ;AQUI SE CONFIGURA EN MODO 8 BITS
   CALL INIT_VARIABLES 
WORM_HOLE 
   BTFSS ENTER
   GOTO WORM_HOLE
   BCF ENTER
   BCF INTCON,7 ;SE DESACTIVAN LAS INTERRUPCIONES PARA QUE SE PUEDA SUMAR EN PAZ
   ;AQUI DEBERIA PROBAR LA BANDERA DE LAS OPERACIONES Y REALIZARLAS 
  ;DEBERIA OPERAR Y GUARDAR EN UNIDAD DECENA Y CENTENA 
  ;DESPUES LLAMAR A MOSTRAR_RESULTADO PARA MOSTRAR ESO
   CALL OPERAR
   CALL MOSTRAR_RESULTADO ;<<<< AQUI SE VA A MOSTRAR UNIDAD, DECENA Y CENTENA
   BSF INTCON,7
   END
